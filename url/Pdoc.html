<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <meta name="copyright" content="MACode ID, https://macodeid.com/">
  <link rel="icon" href="LOGOs.png">
  <title>Medicgenely</title>
  <link rel="stylesheet" href="maicons.css">
  <link rel="stylesheet" href="bootstrap.css">
  <link rel="stylesheet" href="owl.carousel.css">
  <link rel="stylesheet" href="animate.css">
  <link rel="stylesheet" href="theme.css">
  <style>
    /* Custom CSS styles */
    .chat-container {
      height: 70vh;
      overflow-y: scroll;
    }
  </style>
</head>
<body>

    <nav class="navbar navbar-expand-lg navbar-light bg-light shadow-sm">
        <div class="container10">
          <a class="navbar-brand" href="index.html"><span class="text-primary">Medic</span>genely</a>
          <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupport" aria-controls="navbarSupport" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
          </button>
          <div class="collapse navbar-collapse" id="navbarSupport">
            <ul class="navbar-nav ml-auto">
              <li class="nav-item active">
                <a class="nav-link" href="index.html">Inicio</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="formulario.html">Cita</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="doctors.html">Perfil</a>
              </li>
              <li class="nav-item">
                <a class="btn btn-primary ml-lg-3" href="login.html">Salir</a>
              </li>
            </ul>
          </div> <!-- .navbar-collapse -->
        </div> <!-- .container -->
      </nav>

  <div class="container mt-5">
    <div class="row">
      <div class="col-md-4">
        <h2>Pacientes</h2>
        <ul id="patientList" class="list-group">
          <!-- Aquí se cargarán los pacientes -->
          <li class="list-group-item d-flex justify-content-between align-items-center">
            Paciente 1
            <span class="badge badge-primary badge-pill">Activo</span>
          </li>
          <li class="list-group-item d-flex justify-content-between align-items-center">
            Paciente 2
            <span class="badge badge-secondary badge-pill">Offline</span>
          </li>
        </ul>
      </div>
      <div class="col-md-8">
        <div class="chat-container">
          <div id="messageList" class="list-group">
            <!-- Aquí se cargarán los mensajes -->
          </div>
        </div>
        <form id="messageForm" class="mt-3">
          <div class="input-group">
            <textarea id="messageInput" class="form-control" placeholder="Escribe un mensaje..." rows="3"></textarea>
            <div class="input-group-append">
              <button type="submit" class="btn btn-primary">Enviar</button>
            </div>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!-- jQuery y Bootstrap JS (reemplazar con las últimas versiones si es necesario) -->
  <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.4/dist/umd/popper.min.js"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>

  <!-- Script para la lista de pacientes y mensajes -->
  <script>
    $(document).ready(function() {
      // Datos simulados de pacientes y mensajes (para pruebas)
      var patients = [
        { id: 1, name: 'Paciente 1' },
        { id: 2, name: 'Paciente 2' }
      ];

      var messages = {
        1: [ // Mensajes con Paciente 1
          { sender: 'doctor', message: 'Hola, ¿cómo estás?', date: '2024-06-16 10:00 AM' },
          { sender: 'patient', message: 'Bien, gracias. Tengo una pregunta sobre mi tratamiento.', date: '2024-06-16 10:05 AM' }
        ],
        2: [ // Mensajes con Paciente 2
          { sender: 'doctor', message: 'Recuerda tomar la medicación a las 10 PM.', date: '2024-06-15 08:00 PM' }
        ]
      };

      // Función para cargar la lista de pacientes
      function loadPatients() {
        var patientList = $('#patientList');
        patientList.empty(); // Limpiar lista antes de cargar nuevos pacientes
        patients.forEach(function(patient) {
          patientList.append('<li id="patient_' + patient.id + '" class="list-group-item d-flex justify-content-between align-items-center">' + patient.name + '<span class="badge badge-primary badge-pill">Activo</span></li>');
        });
      }

      // Función para cargar los mensajes con un paciente específico
      function loadMessages(patientId) {
        var messageList = $('#messageList');
        messageList.empty(); // Limpiar lista antes de cargar nuevos mensajes
        if (messages.hasOwnProperty(patientId)) {
          messages[patientId].forEach(function(message) {
            var senderClass = (message.sender === 'doctor') ? 'text-primary' : 'text-secondary';
            messageList.append('<div class="list-group-item"><small class="' + senderClass + '">' + message.sender + '</small><p class="mb-1">' + message.message + '</p><small>Fecha: ' + message.date + '</small></div>');
          });
        }
      }

      // Cargar pacientes al cargar la página
      loadPatients();

      // Evento para cambiar de paciente y cargar mensajes
      $('#patientList').on('click', 'li', function() {
        var patientId = $(this).attr('id').split('_')[1]; // Obtener el ID del paciente
        loadMessages(patientId);
        // Simular cambio de paciente activo (actualmente solo un estilo visual, no persiste)
        $('#patientList li').removeClass('active');
        $(this).addClass('active');
      });

      // Evento para enviar un mensaje
      $('#messageForm').submit(function(e) {
        e.preventDefault();
        var messageInput = $('#messageInput').val().trim();
        if (messageInput !== '') {
          var activePatientId = $('#patientList li.active').attr('id').split('_')[1]; // Obtener el ID del paciente activo
          var newMessage = { sender: 'doctor', message: messageInput, date: new Date().toLocaleString() };
          messages[activePatientId].push(newMessage); // Agregar mensaje al arreglo de mensajes
          $('#messageInput').val(''); // Limpiar campo de mensaje
          loadMessages(activePatientId); // Volver a cargar mensajes
        }
      });
    });
  </script>
</body>
</html>
